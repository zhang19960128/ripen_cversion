This is the c_verison
